============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.4.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
rootdir: /home/users/duynguy/proj/sql_exev
configfile: pyproject.toml
plugins: anyio-4.11.0
collecting ... collected 6 items

tests/test_golden_set.py::test_golden_set[01_composite_index] FAILED

=================================== FAILURES ===================================
_____________________ test_golden_set[01_composite_index] ______________________

test_name = '01_composite_index'

    @requires_db
    @requires_llm
    @pytest.mark.golden
    @pytest.mark.parametrize("test_name", list(VILLAIN_QUERIES.keys()))
    def test_golden_set(test_name: str):
        spec = VILLAIN_QUERIES[test_name]
        result = run_exev_gauntlet(spec["sql"])
    
        fb = result.get("feedback", {})
        status = (fb.get("status") or "").lower()
        suggestion = fb.get("suggestion", "") or ""
    
        # 1) Status check
>       assert status == spec["expected_status"], (
            f"[{test_name}] Expected status '{spec['expected_status']}', got '{status}'\n"
            f"Reason: {fb.get('reason')}\nSuggestion: {suggestion}"
        )
E       AssertionError: [01_composite_index] Expected status 'fail', got 'error'
E         Reason: Query execution failed: connection to server at "localhost" (::1), port 5432 failed: Connection refused
E         	Is the server runni...
E         Suggestion: Review PostgreSQL error message
E       assert 'error' == 'fail'
E         
E         - fail
E         + error

tests/test_golden_set.py:116: AssertionError
=========================== short test summary info ============================
FAILED tests/test_golden_set.py::test_golden_set[01_composite_index] - Assert...
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
============================== 1 failed in 3.97s ===============================
